CONTEXTO
O sistema j√° possui:
- Data Lake multissetor (HP di√°rio + Checkin/Checkout di√°rio)
- Forecast Run / Baseline congelado + Adjustment Runs
- Regras trabalhistas globais e regras operacionais por setor
- Calend√°rio operacional e feriados
- Escalas geradas por setor
- Convoca√ß√µes com aceite, recusa e substitui√ß√£o
- Audit Log b√°sico

OBJETIVO DO PROMPT 15
Criar a camada de CONSULTAS, HIST√ìRICOS e INDICADORES, permitindo:
1) Acompanhar o que foi planejado x executado
2) Avaliar comportamento de colaboradores (aceites/recusas)
3) Avaliar efici√™ncia operacional por setor
4) Garantir rastreabilidade jur√≠dica e gerencial
Sem alterar a l√≥gica j√° implementada.

---

# 1) PRINC√çPIO FUNDAMENTAL

Nada ser√° recalculado neste m√≥dulo.
Este m√≥dulo:
- apenas consulta,
- consolida,
- apresenta,
- e exporta dados j√° existentes.

---

# 2) TELAS DE CONSULTA (FRONTEND)

Criar a se√ß√£o:
üìä **Consultas e Hist√≥ricos**

## 2.1 Hist√≥rico de Convoca√ß√µes por Colaborador
Tela:
- Filtros:
  - colaborador
  - setor
  - per√≠odo (data inicial/final)
  - status (aceita, recusada, expirada, substitu√≠da)
- Colunas m√≠nimas:
  - data
  - setor
  - atividade
  - hor√°rio
  - horas totais
  - status
  - origem (BASELINE / ADJUSTMENT)
- Indicadores no topo:
  - % de aceites
  - % de recusas
  - n¬∫ de convoca√ß√µes no per√≠odo
- Exporta√ß√£o:
  - Excel (.xlsx)
  - PDF

## 2.2 Hist√≥rico de Convoca√ß√µes por Setor
Tela:
- Filtros:
  - setor
  - semana ou per√≠odo
- Indicadores:
  - total de convoca√ß√µes
  - horas convocadas
  - horas aceitas
  - horas recusadas
- Tabela detalhada por dia

---

# 3) PLANEJADO x EXECUTADO

## 3.1 Planejado x Executado (por semana)
Tela:
- Selecionar:
  - setor
  - semana
- Exibir:
  - horas planejadas (Schedule)
  - horas convocadas
  - horas aceitas
  - horas efetivamente trabalhadas (quando dispon√≠vel)
- Mostrar diferen√ßas:
  - d√©ficit
  - excedente
- Indicar origem do desvio:
  - recusas
  - ajustes operacionais
  - eventos de calend√°rio

## 3.2 Proje√ß√£o x Real (Forecast Accuracy)
Tela:
- Baseada nos Forecast Runs
- Para cada dia:
  - ocupa√ß√£o projetada (baseline)
  - ocupa√ß√£o ajustada
  - ocupa√ß√£o real
  - erro percentual
- Gr√°ficos simples (linha ou barras)
- M√©trica:
  - erro m√©dio por dia da semana

---

# 4) INDICADORES OPERACIONAIS POR SETOR

Criar painel ‚ÄúIndicadores por Setor‚Äù:

Indicadores m√≠nimos:
- produtividade m√©dia (ex.: quartos/hora, tarefas/hora)
- % meta de aproveitamento de horas
- horas improdutivas estimadas
- impacto de feriados/eventos (%)

Esses indicadores:
- s√£o apenas leitura
- usam par√¢metros j√° cadastrados em Regras Operacionais por Setor
- servem como base para melhoria futura

---

# 5) GOVERNAN√áA E COMPLIANCE

## 5.1 Linha do Tempo Jur√≠dica por Colaborador
Para qualquer colaborador, permitir visualizar:
- convoca√ß√µes emitidas
- prazo de anteced√™ncia
- resposta
- regras aplicadas
- substitui√ß√µes

Objetivo:
- permitir reconstruir toda a rela√ß√£o de trabalho em caso de auditoria ou a√ß√£o judicial.

## 5.2 Audit Log Avan√ßado (Consulta)
Criar tela para:
- filtrar audit_log por:
  - tipo de evento
  - usu√°rio
  - per√≠odo
- Exportar logs (CSV)

---

# 6) EXPORTA√á√ïES

Para TODAS as telas principais:
- Exportar Excel (.xlsx)
- Exportar PDF

Exporta√ß√µes devem:
- refletir exatamente os filtros aplicados
- conter data/hora da extra√ß√£o
- conter identifica√ß√£o do setor e per√≠odo

---

# 7) BACKEND ‚Äî APOIO

Criar endpoints de leitura:
- /reports/convocations/by-employee
- /reports/convocations/by-sector
- /reports/planned-vs-executed
- /reports/forecast-accuracy
- /reports/sector-indicators
- /reports/audit-log

Esses endpoints:
- n√£o devem alterar dados
- devem usar queries agregadas
- devem ser perform√°ticos (indexes se necess√°rio)

---

# 8) UX E USABILIDADE

- Telas devem carregar r√°pido (lazy load se necess√°rio)
- Mensagens claras quando n√£o houver dados
- Nenhuma tela deve quebrar se per√≠odo estiver vazio

---

# 9) CRIT√âRIOS DE ACEITA√á√ÉO

Este prompt ser√° considerado conclu√≠do quando:
1) Eu conseguir consultar hist√≥rico completo de convoca√ß√µes por colaborador e setor.
2) Eu conseguir comparar planejado x executado por semana.
3) Eu conseguir ver proje√ß√£o x real com erro m√©dio por dia da semana.
4) Eu conseguir exportar todos os relat√≥rios em Excel e PDF.
5) Eu conseguir reconstruir a linha do tempo jur√≠dica de qualquer colaborador.
6) Nada do operacional (escalas/convoca√ß√µes) for impactado negativamente.

RESTRI√á√ïES
- N√ÉO recalcular dados hist√≥ricos.
- N√ÉO alterar Forecast Runs j√° existentes.
- N√ÉO alterar regras trabalhistas ou operacionais.
- Tudo deve ser somente leitura.

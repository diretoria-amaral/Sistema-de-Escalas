
---

# PROMPT B â€” Cadastro de Regra Trabalhista: campos do formulÃ¡rio + validade + bug de tela branca

## Problema 1: Campos do formulÃ¡rio pequenos demais
Campos como pergunta/resposta precisam suportar textos longos (regras trabalhistas sÃ£o extensas).

### CorreÃ§Ã£o de UI
- Transformar `pergunta` e `resposta` em **TextArea autosize** (mÃ­n 4 linhas, mÃ¡ximo ~16 linhas com scroll)
- `codigo_regra` curto (input simples)
- `metadados_json` opcional com editor expansÃ­vel (accordion)

---

## Problema 2: Datas de validade (inÃ­cio/fim) nÃ£o fazem sentido para vocÃª
VocÃª nÃ£o estÃ¡ vendo utilidade e isso estÃ¡ atrapalhando.

### SoluÃ§Ã£o correta (sem perder robustez)
**NÃ£o remover do banco** (isso quebra governanÃ§a/versionamento futuro), mas:
- Tornar **opcional** e **avanÃ§ado** no UI:
  - esconder por padrÃ£o em â€œOpÃ§Ãµes avanÃ§adasâ€
  - default: sem datas (regra vigente por tempo indeterminado)
- Na listagem, nÃ£o mostrar datas se vazias.

ğŸ“Œ Motivo tÃ©cnico para manter (sem te impor):
- permite versionar regras sem apagar histÃ³rico
- permite mudar regra â€œa partir de uma dataâ€ sem perder rastreabilidade

---

## Problema 3: Ao clicar â€œCriarâ€, fecha e fica tela branca
Isso Ã© bug de navegaÃ§Ã£o/estado (React). Quase sempre Ã©:
- exceÃ§Ã£o nÃ£o tratada apÃ³s submit
- erro no retorno do endpoint
- rota redirecionando para caminho inexistente
- state setState em componente desmontado
- crash por JSON mal parseado

### CorreÃ§Ã£o obrigatÃ³ria
1) Envolver submit com try/catch real
2) Mostrar toast de erro com mensagem do backend
3) NÃ£o fazer redirect se a resposta nÃ£o vier ok
4) Logar no console com contexto (apenas dev)
5) Garantir que apÃ³s criar:
   - o modal fecha
   - a lista recarrega
   - mantÃ©m o setor selecionado
6) Criar boundary simples (ErrorBoundary) para nÃ£o â€œbranquearâ€ a tela:
   - exibir fallback: â€œOcorreu um erro na tela. Clique para recarregar.â€

### Backend
- Validar payload e retornar erro bem formado (HTTP 422/400) com mensagem clara.
- Garantir que POST /api/rules retorna o objeto criado no formato esperado pelo frontend.

Entregar:
- Fix aplicado e reproduzido: â€œCriar regra trabalhistaâ€ nÃ£o pode derrubar a tela.
